<div class="sidetabs vertical-tabs">
    <nav class="sidetab-switch">
        <ul>
            <li><a class="default-sidetab current" href="#summary"><?php echo _('Summary'); ?></a></li>
            <li><a  href="#activity"><?php echo _('Recent Activity'); ?></a></li>
            <li><a  href="#updates"><?php echo _('News and Updates'); ?></a></li>
        </ul>
    </nav>
    <div class="sidetab default-sidetab padding-20" id="summary" style="display: block;"> 
        <form action="<?php echo $this->link('/system/admin/index!#summary') ?>">
            <div class="grid whole">
                <div class="row clearfix whole">
                    <div class="col half" align="left"><?php echo _('Welcome back! Here is a summary for activity on your site') ?></div>
                    <div class="col half" align="right">
                        <select style="width:250px" name="date-range">
                            <option id="-30"><?php echo _('The last 30 days'); ?></option>
                            <option id="-7"><?php echo _('The last Week'); ?></option>
                            <option id="-1"><?php echo _('Yesterday'); ?></option>
                            <option id="0"><?php echo _('Today - Live'); ?></option>
                        </select>
                    </div>
                </div>
                <div id="in-numbers" class="row clearfix whole">

                    <div class="col fifth">
                        <a href="#" class="clearfix">
                            <span class="count-head">Visits</span>
                            <span class="count-body">189</span>
                            <span class="count-footer">% of Total: 5% (3702 in total)</span>
                        </a>
                    </div>
                    <div class="col fifth">
                        <a href="#" class="clearfix">
                            <span class="count-head">Page Visits</span>
                            <span class="count-body">189.00</span>
                            <span class="count-footer">Site avg. 1(189%)</span>
                        </a>
                    </div>
                    <div class="col fifth">
                        <a href="#" class="clearfix">
                            <span class="count-head">Average Time on Site</span>
                            <span class="count-body">00:00:00</span>
                            <span class="count-footer">Site avg. 00:00:00 : 0% </span>
                        </a>
                    </div>
                    <div class="col fifth">
                        <a href="#" class="clearfix">
                            <span class="count-head">% of new visits</span>
                            <span class="count-body">0.00%</span>
                            <span class="count-footer">Site avg. 0.00%: 0%</span>
                        </a>
                    </div>
                    <div class="col fifth">
                        <a href="#" class="clearfix">
                            <span class="count-head">Bounce Rates</span>
                            <span class="count-body">100%</span>
                            <span class="count-footer">Site avg. 100%</span>
                        </a>
                    </div>

                </div>
                <div id="placeholder" class="row whole" style="height: 300px; margin-bottom: 10px"></div>
                <div class="row whole">
                    additional settings
                </div>
            </div>
        </form>
    </div>
    <div class="sidetab padding-20" id="activity" style="display:none">
        Activity
    </div>
    <div class="sidetab padding-20" id="updates" style="display:none">
        System updates
    </div>
</div>


<style>
    #in-numbers{background: #f9f9f9; margin: 15px 0}
    #in-numbers div a {padding: 10px; display: block}
    #in-numbers div a:hover{background: #f4f4f4}
    #in-numbers div a span{display:block}
    #in-numbers div a span.count-head{font-size: 13px; font-weight: 600}
    #in-numbers div a span.count-body{font-size: 20px; font-weight: bolder; margin: 4px 0; color: inherit}
    #in-numbers div a span.count-footer{font-size: 10px}
</style>

<script type="text/javascript" src="/<?php echo $this->getTemplateName() ?>/js/plugins/jquery.flot.js"></script>
<script type="text/javascript">
$(function () {
    var a = [[1.3186368e+12,0],[1.3187232e+12,0],[1.3188096e+12,0],[1.318896e+12,0],[1.3189824e+12,0],[1.3190688e+12,0],[1.3191552e+12,0],[1.3192416e+12,4],[1.319328e+12,0],[1.3194144e+12,0],[1.3195008e+12,0],[1.3195872e+12,0],[1.3196736e+12,0],[1.31976e+12,0],[1.3198464e+12,0],[1.3199328e+12,0],[1.3200192e+12,0],[1.3201056e+12,0],[1.320192e+12,0],[1.3202784e+12,0],[1.3203648e+12,0],[1.3204512e+12,0],[1.3205376e+12,0],[1.320624e+12,0],[1.3207104e+12,0],[1.3207968e+12,0],[1.3208832e+12,0],[1.3209696e+12,0],[1.321056e+12,0],[1.3211424e+12,0],[1.3212288e+12,0],[1.3213152e+12,0],[1.3214016e+12,0],[1.321488e+12,0],[1.3215744e+12,0],[1.3216608e+12,0],[1.3217472e+12,0],[1.3218336e+12,0],[1.32192e+12,0],[1.3220064e+12,0],[1.3220928e+12,0],[1.3221792e+12,0],[1.3222656e+12,0],[1.322352e+12,0],[1.3224384e+12,0],[1.3225248e+12,0],[1.3226112e+12,0],[1.3226976e+12,0],[1.322784e+12,0],[1.3228704e+12,0],[1.3229568e+12,0],[1.3230432e+12,0],[1.3231296e+12,0],[1.323216e+12,0],[1.3233024e+12,0],[1.3233888e+12,0],[1.3234752e+12,0],[1.3235616e+12,0],[1.323648e+12,0],[1.3237344e+12,0],[1.3238208e+12,0],[1.3239072e+12,0],[1.3239936e+12,0],[1.32408e+12,0],[1.3241664e+12,0],[1.3242528e+12,0],[1.3243392e+12,0],[1.3244256e+12,0],[1.324512e+12,0],[1.3245984e+12,0],[1.3246848e+12,0],[1.3247712e+12,0],[1.3248576e+12,0],[1.324944e+12,0],[1.3250304e+12,0],[1.3251168e+12,0],[1.3252032e+12,0],[1.3252896e+12,0],[1.325376e+12,0],[1.3254624e+12,0],[1.3255488e+12,0],[1.3256352e+12,0],[1.3257216e+12,0],[1.325808e+12,0],[1.3258944e+12,0],[1.3259808e+12,0],[1.3260672e+12,0],[1.3261536e+12,0],[1.32624e+12,0],[1.3263264e+12,0],[1.3264128e+12,0],[1.3264992e+12,0],[1.3265856e+12,0]],
        b = [[1.318705478e+12,0],[1.3186368e+12,0],[1.3187232e+12,0],[1.3188096e+12,0],[1.318896e+12,0],[1.3189824e+12,0],[1.3190688e+12,0],[1.3191552e+12,0],[1.3192416e+12,0],[1.319328e+12,0],[1.3194144e+12,0],[1.3195008e+12,0],[1.3195872e+12,0],[1.3196736e+12,0],[1.31976e+12,0],[1.3198464e+12,0],[1.3199328e+12,0],[1.3200192e+12,0],[1.3201056e+12,0],[1.320192e+12,0],[1.3202784e+12,0],[1.3203648e+12,0],[1.3204512e+12,0],[1.3205376e+12,0],[1.320624e+12,0],[1.3207104e+12,0],[1.3207968e+12,0],[1.3208832e+12,0],[1.3209696e+12,0],[1.321056e+12,0],[1.3211424e+12,0],[1.3212288e+12,0],[1.3213152e+12,0],[1.3214016e+12,0],[1.321488e+12,0],[1.3215744e+12,0],[1.3216608e+12,0],[1.3217472e+12,0],[1.3218336e+12,0],[1.32192e+12,0],[1.3220064e+12,0],[1.3220928e+12,0],[1.3221792e+12,0],[1.3222656e+12,0],[1.322352e+12,0],[1.3224384e+12,0],[1.3225248e+12,0],[1.3226112e+12,0],[1.3226976e+12,0],[1.322784e+12,0],[1.3228704e+12,0],[1.3229568e+12,0],[1.3230432e+12,0],[1.3231296e+12,0],[1.323216e+12,0],[1.3233024e+12,0],[1.3233888e+12,0],[1.3234752e+12,52],[1.3235616e+12,100],[1.323648e+12,90],[1.3237344e+12,189],[1.3238208e+12,0],[1.3239072e+12,0],[1.3239936e+12,0],[1.32408e+12,0],[1.3241664e+12,0],[1.3242528e+12,0],[1.3243392e+12,0],[1.3244256e+12,0],[1.324512e+12,0],[1.3245984e+12,0],[1.3246848e+12,0],[1.3247712e+12,0],[1.3248576e+12,0],[1.324944e+12,0],[1.3250304e+12,0],[1.3251168e+12,0],[1.3252032e+12,0],[1.3252896e+12,0],[1.325376e+12,0],[1.3254624e+12,0],[1.3255488e+12,0],[1.3256352e+12,0],[1.3257216e+12,0],[1.325808e+12,0],[1.3258944e+12,0],[1.3259808e+12,0],[1.3260672e+12,0],[1.3261536e+12,0],[1.32624e+12,0],[1.3263264e+12,0],[1.3264128e+12,0],[1.3264992e+12,0],[1.3265856e+12,0]],
        c = [],
        d = [[1.3242528e+12,2],[1.3243392e+12,2],[1.3244256e+12,2],[1.324512e+12,3],[1.3245984e+12,0],[1.3246848e+12,0],[1.3247712e+12,0],[1.3248576e+12,0],[1.324944e+12,1],[1.3250304e+12,2],[1.3251168e+12,0],[1.3252032e+12,0],[1.3252896e+12,0],[1.325376e+12,0],[1.3254624e+12,0],[1.3255488e+12,0],[1.3256352e+12,0],[1.3257216e+12,0],[1.325808e+12,0],[1.3258944e+12,45],[1.3259808e+12,100],[1.3260672e+12,197],[1.3261536e+12,201],[1.32624e+12,225],[1.3263264e+12,207],[1.3264128e+12,172],[1.3264992e+12,150],[1.3265856e+12,189]];
    // first correct the timestamps - they are recorded as the daily
    // midnights in UTC+0100, but Flot always displays dates in UTC
    // so we have to add one hour to hit the midnights in the plot
    for (var i = 0; i < d.length; ++i)
      d[i][0] += 60 * 60 * 1000;
    
    for (var i = 0; i < a.length; ++i)
      a[i][0] += 60 * 60 * 1000;
  

    // helper for returning the weekends in a period
    function weekendAreas(axes) {
        var markings = [];
        var d = new Date(axes.xaxis.min);
        // go to the first Saturday
        d.setUTCDate(d.getUTCDate() - ((d.getUTCDay() + 1) % 7))
        d.setUTCSeconds(0);
        d.setUTCMinutes(0);
        d.setUTCHours(0);
        var i = d.getTime();
        do {
            // when we don't set yaxis, the rectangle automatically
            // extends to infinity upwards and downwards
            markings.push({ xaxis: { from: i, to: i + 2 * 24 * 60 * 60 * 1000 } });
            i += 7 * 24 * 60 * 60 * 1000;
        } while (i < axes.xaxis.max);

        return markings;
    }
    
    var options = {
        xaxis: { mode: "time" },
        selection: { mode: "x" },
        crosshair: { mode: "x" },
        lines: {steps: false},
        legend: {position: "nw" },
        grid: { hoverable: true, clickable: true ,borderWidth: 0, borderColor: null},
        series:{ lines: { show: true,  fill: 0.2, lineWidth: 4 },points: { show: true , radius:3, symbol:"circle" } },
        colors: [ "rgb(255, 100, 123)", "rgb(94, 134, 231)", "rgb(87, 147, 189)", "rgb(87, 147, 189)" ]
    };
    
    var plot = $.plot($("#placeholder"), [{data:d,color:3}], options);
    
    function showTooltip(x, y, contents) {
        $('<div id="tooltip">' + contents + '</div>').css( {
            position: 'absolute',
            display: 'none',
            top: y + 5,
            left: x + 5,
            border: '1px solid #fdd',
            padding: '2px',
            'background-color': '#fee',
            opacity: 0.80
        }).appendTo("body").fadeIn(200);
    }

    var previousPoint = null;
    $("#placeholder").bind("plothover", function (event, pos, item) {
        $("#x").text(pos.x.toFixed(2));
        $("#y").text(pos.y.toFixed(2));

            if (item) {
                if (previousPoint != item.datapoint) {
                    previousPoint = item.datapoint;
                    
                    $("#tooltip").remove();
                    var x = item.datapoint[0].toFixed(0),
                        y = item.datapoint[1].toFixed(0),
                     date = new Date(x/1000),
                     day  = date.getDay(),
                    month = date.getMonth(),
                    year  = date.getYear(),
                    hours = date.getHours(),
                  minutes = date.getMinutes(),
                  seconds = date.getSeconds(),
            formattedTime = day+'/'+month+'/'+year+' at '+hours + ' hours : ' + minutes + ' mins : ' + seconds+' sec';
                    
                    showTooltip(item.pageX, item.pageY,
                                y + " "+ item.series.label );
                }
            }
            else {
                $("#tooltip").remove();
                previousPoint = null;            
            }
        
    });

    $("#placeholder").bind("plotclick", function (event, pos, item) {
        if (item) {
            //alert("You clicked point " + item.dataIndex + " in " + item.series.label + ".");
            plot.highlight(item.series, item.datapoint);
        }
    });

    // now connect the two
    
    $("#placeholder").bind("plotselected", function (event, ranges) {
        // do the zooming
        plot = $.plot($("#placeholder"), [{data:a,label: "page views",color:0},{data:b,label: "new members", color:1},{data:c,label: "time on site",color:2},{data:d,label: "status updates",color:3}],
                      $.extend(true, {}, options, {
                          xaxis: { min: ranges.xaxis.from, max: ranges.xaxis.to }
                      }));

        // don't fire event on the overview to prevent eternal loop
        //overview.setSelection(ranges, true);
    });
});
</script>